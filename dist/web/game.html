<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>–ö—Ä–µ—Å—Ç–∏–∫–∏-–ù–æ–ª–∏–∫–∏</title>
    
    <!-- Telegram WebApp SDK -->
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    
    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Playfair+Display:wght@700&display=swap" rel="stylesheet">
    
    <!-- Styles -->
    <link rel="stylesheet" href="/web/assets/css/variables.css">
    <link rel="stylesheet" href="/web/assets/css/main.css">
    
    <!-- Prevent caching -->
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
    <meta http-equiv="Pragma" content="no-cache">
    <meta http-equiv="Expires" content="0">
</head>
<body>
    <div class="game-container">
        <h1>üéÆ –ö—Ä–µ—Å—Ç–∏–∫–∏-–ù–æ–ª–∏–∫–∏</h1>
        
        <!-- –ì–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é (–ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é) -->
        <div id="main-menu" class="main-menu">
            <button id="play-btn" class="button button-primary">
                üéÆ –ò–≥—Ä–∞—Ç—å
            </button>
            <button id="history-btn" class="button button-secondary">
                üìä –ò—Å—Ç–æ—Ä–∏—è –∏–≥—Ä
            </button>
        </div>
        
        <!-- –ò–≥—Ä–æ–≤–æ–µ –ø–æ–ª–µ (—Å–∫—Ä—ã—Ç–æ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é) -->
        <div id="game-screen" class="game-screen hidden">
            <div id="game-board" class="game-board"></div>
            
            <!-- –°–æ–æ–±—â–µ–Ω–∏—è -->
            <div id="message-container"></div>
            
            <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ (–ø–æ–≤–µ—Ä—Ö –∏–≥—Ä–æ–≤–æ–≥–æ –ø–æ–ª—è) -->
            <div id="result-modal" class="result-modal hidden">
                <div class="result-modal-backdrop"></div>
                <div class="result-modal-content">
                    <div id="result-icon" class="result-icon" style="display: none;"></div>
                    <h2 id="result-title" class="result-title"></h2>
                    <p id="result-message" class="result-message"></p>
                    
                    <!-- –ö–Ω–æ–ø–∫–∞ –æ—Ç–∫—Ä—ã—Ç—å –ø—Ä–∏–∑ -->
                    <button id="open-prize-btn" class="button button-primary button-prize">üéÅ –û—Ç–∫—Ä—ã—Ç—å –ø—Ä–∏–∑</button>
                    
                    <!-- Canvas –¥–ª—è –ø–æ–∑–¥—Ä–∞–≤–∏—Ç–µ–ª—å–Ω—ã—Ö –≤—Å–ø—ã—à–µ–∫ -->
                    <canvas id="confetti-canvas" class="confetti-canvas"></canvas>
                </div>
            </div>
            
            <!-- –ü–æ–ª–Ω–æ—ç–∫—Ä–∞–Ω–Ω–æ–µ –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–ª—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –ø—Ä–∏–∑–∞ -->
            <div id="prize-image-modal" class="prize-image-modal hidden">
                <div class="prize-image-backdrop"></div>
                <div class="prize-image-container">
                    <button id="close-prize-btn" class="prize-close-btn">‚úï</button>
                    <img id="prize-image" class="prize-image" src="" alt="–ü—Ä–∏–∑">
                </div>
            </div>
        </div>
        
        <!-- –≠–∫—Ä–∞–Ω –∏—Å—Ç–æ—Ä–∏–∏ (—Å–∫—Ä—ã—Ç –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é) -->
        <div id="history-screen" class="history-screen hidden">
            <h2>üìä –ò—Å—Ç–æ—Ä–∏—è –∏–≥—Ä</h2>
            <div id="history-content" class="history-content">
                <!-- –ö–æ–Ω—Ç–µ–Ω—Ç –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
            </div>
            <button id="back-to-menu-from-history-btn" class="button button-secondary mt-lg">üè† –í –º–µ–Ω—é</button>
        </div>
    </div>
    
    <!-- Scripts -->
    <script src="/web/assets/js/telegram-api.js?v=7"></script>
    <script src="/web/assets/js/game.js?v=7"></script>
    <script src="/web/assets/js/history.js?v=7"></script>
    <script src="/web/assets/js/navigation.js?v=7"></script>
    
    <!-- Force reload styles and scripts on page load -->
    <script>
        // –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∏–ª–µ–π –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
        (function() {
            // –û–±–Ω–æ–≤–ª—è–µ–º CSS —Ñ–∞–π–ª—ã
            const links = document.querySelectorAll('link[rel="stylesheet"]');
            links.forEach(function(link) {
                const href = link.getAttribute('href');
                if (href && !href.includes('fonts.googleapis.com') && !href.includes('fonts.gstatic.com')) {
                    const baseHref = href.split('?')[0];
                    link.href = baseHref + '?v=' + Date.now();
                }
            });
            
            // –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–∫—Ä–∏–ø—Ç–æ–≤
            const scripts = document.querySelectorAll('script[src]');
            scripts.forEach(function(script) {
                const src = script.getAttribute('src');
                if (src && !src.includes('telegram.org') && !src.includes('?')) {
                    script.src = src + '?v=' + Date.now();
                }
            });
            
            // –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∏–ª–µ–π –ø–æ—Å–ª–µ –∑–∞–≥—Ä—É–∑–∫–∏
            window.addEventListener('load', function() {
                // –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω—ã–π reflow –¥–ª—è –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è –≤—Å–µ—Ö —Å—Ç–∏–ª–µ–π
                document.body.offsetHeight;
                
                // –û–±–Ω–æ–≤–ª—è–µ–º computed styles –¥–ª—è –≤—Å–µ—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤
                const allElements = document.querySelectorAll('*');
                allElements.forEach(function(el) {
                    if (window.getComputedStyle) {
                        window.getComputedStyle(el);
                    }
                });
            });
        })();
    </script>
</body>
</html>

