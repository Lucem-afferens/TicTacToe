# Структура проекта Telegram Bot Game «Крестики-Нолики»

## 📁 Полная структура проекта

```
tic-tac-toe-telegram-bot/
│
├── .cursor/
│   └── rules.md                 # Правила разработки проекта
│
├── bot/                         # Telegram Bot модуль
│   ├── index.ts                 # Точка входа бота
│   ├── bot.ts                   # Основная логика Telegram API
│   ├── handlers/                # Обработчики команд и событий
│   │   ├── commands.ts          # Обработка команд (/start, /help)
│   │   ├── webapp.ts            # Обработка Web App событий
│   │   └── errors.ts            # Обработка ошибок
│   ├── messages.ts              # Тексты сообщений бота
│   ├── promo.ts                 # Генерация и валидация промокодов
│   ├── session.ts               # Управление сессиями пользователей
│   ├── config.ts                # Конфигурация (токены, env)
│   └── types.ts                 # Типы для бота
│
├── web/                         # Web App модуль
│   ├── index.html               # Главная страница игры
│   │
│   ├── styles/                  # Стили
│   │   ├── variables.css        # CSS переменные (дизайн-система)
│   │   ├── main.css             # Основные стили игры
│   │   ├── game.css             # Стили игрового поля
│   │   └── components.css       # Стили компонентов (кнопки, модалки)
│   │
│   ├── scripts/                 # TypeScript логика
│   │   ├── main.ts              # Инициализация приложения
│   │   ├── telegram.ts          # Интеграция с Telegram Web App SDK
│   │   ├── game.ts              # Логика игры крестики-нолики
│   │   ├── ai.ts                # AI логика бота-соперника
│   │   ├── promo.ts             # Отображение и обработка промокодов
│   │   ├── ui.ts                # Управление UI состояниями
│   │   └── utils.ts             # Вспомогательные функции
│   │
│   └── assets/                  # Статические ресурсы
│       ├── icons/               # Иконки (SVG)
│       └── fonts/               # Шрифты (если локальные)
│
├── shared/                      # Общие модули
│   ├── types.ts                 # Общие типы данных
│   ├── constants.ts             # Общие константы
│   ├── game-logic.ts            # Общая игровая логика (проверка победы)
│   └── utils.ts                 # Общие утилиты
│
├── tests/                       # Тесты
│   ├── unit/                    # Unit тесты
│   │   ├── game.test.ts
│   │   ├── ai.test.ts
│   │   └── promo.test.ts
│   └── integration/             # Интеграционные тесты
│       └── bot-web.test.ts
│
├── docs/                        # Документация
│   ├── API.md                   # API документация
│   └── DEPLOYMENT.md            # Инструкции по деплою
│
├── .env.example                 # Пример переменных окружения
├── .gitignore                   # Git ignore правила
├── tsconfig.json                # TypeScript конфигурация
├── package.json                 # Зависимости и скрипты
├── README.md                    # Основная документация проекта
│
└── PROJECT_STRUCTURE.md          # Этот файл
```

## 🔍 Описание модулей

### `/bot` - Telegram Bot
**Назначение**: Обработка команд, взаимодействие с Telegram API, управление сессиями

**Ключевые файлы**:
- `index.ts` - Запуск бота, инициализация
- `bot.ts` - Настройка бота, middleware, роутинг
- `handlers/commands.ts` - `/start`, `/help`, обработка команд
- `handlers/webapp.ts` - Получение данных от Web App
- `messages.ts` - Все текстовые сообщения бота
- `promo.ts` - Генерация промокодов (синхронизировано с web)
- `session.ts` - Хранение состояния пользователей

### `/web` - Web Application
**Назначение**: Игровой интерфейс, взаимодействие с пользователем

**Ключевые файлы**:
- `index.html` - Разметка игры
- `scripts/main.ts` - Инициализация, загрузка Telegram SDK
- `scripts/telegram.ts` - Обёртка над Telegram Web App SDK
- `scripts/game.ts` - Логика игры (ходы, проверка победы)
- `scripts/ai.ts` - AI логика (60/30/10 стратегия)
- `scripts/promo.ts` - Отображение промокода при победе
- `scripts/ui.ts` - Управление экранами (игра/победа/проигрыш)

**Стили**:
- `variables.css` - Дизайн-система (цвета, шрифты, отступы)
- `main.css` - Общие стили, layout
- `game.css` - Стили игрового поля
- `components.css` - Переиспользуемые компоненты

### `/shared` - Общие модули
**Назначение**: Код, используемый и в bot, и в web

**Ключевые файлы**:
- `types.ts` - Общие типы (GameState, Player, Move и т.д.)
- `constants.ts` - Константы (размер поля, символы)
- `game-logic.ts` - Функции проверки победы, валидации ходов
- `utils.ts` - Утилиты (генерация промокодов, форматирование)

## 🔗 Взаимодействие модулей

```
┌─────────────┐
│ Telegram Bot│
│   (/bot)    │
└──────┬──────┘
       │ Web App Button
       │ (открывает игру)
       ↓
┌─────────────┐
│  Web App    │
│   (/web)    │
└──────┬──────┘
       │ sendData()
       │ (результат игры)
       ↓
┌─────────────┐
│ Telegram Bot│
│ (получает   │
│  промокод)  │
└─────────────┘

Общие типы и логика:
┌─────────────┐
│   /shared   │
└─────────────┘
```

## 📦 Зависимости между модулями

- **bot** → **shared** (использует типы и константы)
- **web** → **shared** (использует типы, константы, игровую логику)
- **bot** ↔ **web** (взаимодействие через Telegram Web App API)

## 🚫 Ограничения

- **bot** НЕ должен импортировать из **web**
- **web** НЕ должен импортировать из **bot**
- Все общие зависимости должны быть в **shared**

## 📝 Примечания

- Структура позволяет независимую разработку bot и web модулей
- Общая логика в shared обеспечивает консистентность
- Тесты изолированы по модулям
- Легко масштабировать (добавить новые игры, функции)

